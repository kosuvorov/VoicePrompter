(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const c of i)if(c.type==="childList")for(const s of c.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&a(s)}).observe(document,{childList:!0,subtree:!0});function o(i){const c={};return i.integrity&&(c.integrity=i.integrity),i.referrerPolicy&&(c.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?c.credentials="include":i.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function a(i){if(i.ep)return;i.ep=!0;const c=o(i);fetch(i.href,c)}})();const W="modulepreload",H=function(t){return"/Teleprompter/"+t},I={},P=function(n,o,a){let i=Promise.resolve();if(o&&o.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),l=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));i=Promise.allSettled(o.map(p=>{if(p=H(p),p in I)return;I[p]=!0;const g=p.endsWith(".css"),f=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${f}`))return;const u=document.createElement("link");if(u.rel=g?"stylesheet":W,g||(u.as="script"),u.crossOrigin="",u.href=p,l&&u.setAttribute("nonce",l),document.head.appendChild(u),g)return new Promise((d,T)=>{u.addEventListener("load",d),u.addEventListener("error",()=>T(new Error(`Unable to preload CSS for ${p}`)))})}))}function c(s){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=s,window.dispatchEvent(l),!l.defaultPrevented)throw s}return i.then(s=>{for(const l of s||[])l.status==="rejected"&&c(l.reason);return n().catch(c)})};function $(t={}){const{immediate:n=!1,onNeedRefresh:o,onOfflineReady:a,onRegistered:i,onRegisteredSW:c,onRegisterError:s}=t;let l,p;const g=async(u=!0)=>{await p};async function f(){if("serviceWorker"in navigator){const{Workbox:u}=await P(async()=>{const{Workbox:d}=await import("./workbox-window.prod.es5-vqzQaGvo.js");return{Workbox:d}},[]);l=new u("/Teleprompter/sw.js",{scope:"/Teleprompter/",type:"classic"}),l.addEventListener("activated",d=>{(d.isUpdate||d.isExternal)&&window.location.reload()}),l.addEventListener("installed",d=>{d.isUpdate||a==null||a()}),l.register({immediate:n}).then(d=>{c?c("/Teleprompter/sw.js",d):i==null||i(d)}).catch(d=>{s==null||s(d)})}}return p=f(),g}$({immediate:!0});const r={isListening:!1,scriptWords:[],currentIndex:0,recognition:null,isMirrored:!1,config:{fontSize:20,lineHeight:1.5,margin:window.innerWidth<768?8:32,textColor:"#ffffff",bgColor:"#000000",textAlign:"center",showStopIcon:!1}},e={setupScreen:document.getElementById("setupScreen"),prompterContainer:document.getElementById("prompterContainer"),inputScript:document.getElementById("inputScript"),scriptContent:document.getElementById("scriptContent"),scrollContainer:document.getElementById("scrollContainer"),topSpacer:document.getElementById("topSpacer"),settingsPanel:document.getElementById("settingsPanel"),fontSizeInput:document.getElementById("fontSizeInput"),fontSizeVal:document.getElementById("fontSizeVal"),lineHeightInput:document.getElementById("lineHeightInput"),lineHeightVal:document.getElementById("lineHeightVal"),marginInput:document.getElementById("marginInput"),marginVal:document.getElementById("marginVal"),textColorInput:document.getElementById("textColorInput"),bgColorInput:document.getElementById("bgColorInput"),appBody:document.getElementById("appBody"),micButton:document.getElementById("micButton"),micIcon:document.getElementById("micIcon"),statusIndicator:document.getElementById("statusIndicator"),mirrorBtn:document.getElementById("mirrorBtn"),mirrorToggleKnob:document.getElementById("mirrorToggleKnob"),browserWarning:document.getElementById("browserWarning"),historyList:document.getElementById("historyList"),historySection:document.getElementById("historySection"),stopSignToggle:document.getElementById("stopSignToggle"),alignBtns:{left:document.getElementById("alignLeftBtn"),center:document.getElementById("alignCenterBtn"),right:document.getElementById("alignRightBtn")},loadScriptBtn:document.getElementById("loadScriptBtn"),clearHistoryBtn:document.getElementById("clearHistoryBtn"),resetAppBtn:document.getElementById("resetAppBtn"),restartScriptBtn:document.getElementById("restartScriptBtn"),toggleSettingsBtn:document.getElementById("toggleSettingsBtn"),themeDarkBtn:document.getElementById("themeDarkBtn"),themeLightBtn:document.getElementById("themeLightBtn"),copyScriptBtn:document.getElementById("copyScriptBtn"),clearScriptBtn:document.getElementById("clearScriptBtn"),pasteScriptBtn:document.getElementById("pasteScriptBtn")},E=window.SpeechRecognition||window.webkitSpeechRecognition;E?(r.recognition=new E,r.recognition.continuous=!0,r.recognition.interimResults=!0,r.recognition.lang="en-US"):e.browserWarning.classList.remove("hidden");v();F();e.marginInput.value=String(r.config.margin);e.marginVal.textContent=`${r.config.margin}px`;e.scriptContent.style.paddingLeft=`${r.config.margin}px`;e.scriptContent.style.paddingRight=`${r.config.margin}px`;function C(t=null){let n=t||e.inputScript.value.trim();if(!n)return alert("Please enter some text.");t||O(n),n=n.replace(/\n+/g," ||LB|| ");const o=n.split(/\s+/);let a=!1;r.scriptWords=o.map(i=>{if(i==="||LB||")return{word:"ðŸ›‘",clean:"",element:null,skip:!0,isStop:!0};i.startsWith("[")&&(a=!0);const c=i.toLowerCase().replace(/[^\w\s]|_/g,"").replace(/\s+/g," "),s=c.length===0,l=a||s||i.includes("ðŸ›‘");return i.endsWith("]")&&(a=!1),{word:i,clean:c,element:null,skip:l,isStop:!1}}),e.scriptContent.innerHTML="",r.scriptWords.forEach((i,c)=>{const s=document.createElement("span");s.textContent=i.word,s.id=`word-${c}`;let l="script-word transition-opacity duration-300 ";i.isStop?l+="stop-marker ":i.skip?l+="skipped-word ":l+="text-future hover:text-blue-400 ",s.className=l,s.onclick=()=>{i.skip||(r.currentIndex=c,m(),B())},e.scriptContent.appendChild(s),i.element=s}),r.config.showStopIcon?e.scriptContent.classList.add("show-stops"):e.scriptContent.classList.remove("show-stops"),e.setupScreen.classList.add("hidden"),e.prompterContainer.classList.remove("hidden"),r.currentIndex=0,L(),m()}function L(){for(;r.currentIndex<r.scriptWords.length&&r.scriptWords[r.currentIndex].skip;)r.currentIndex++}function A(){k(),e.prompterContainer.classList.add("hidden"),e.setupScreen.classList.remove("hidden"),v()}function b(){r.currentIndex=0,L(),m(),B(),e.scrollContainer.scrollTop=0}function O(t){let n=JSON.parse(localStorage.getItem("teleprompter_history")||"[]");if(n.length>0&&n[0].text===t)return;const o={id:Date.now(),text:t,preview:t.substring(0,40)+(t.length>40?"...":""),date:new Date().toLocaleDateString()};n.unshift(o),n.length>10&&n.pop(),localStorage.setItem("teleprompter_history",JSON.stringify(n))}function v(){let t=JSON.parse(localStorage.getItem("teleprompter_history")||"[]");if(e.historyList.innerHTML="",t.length===0){e.historyList.innerHTML=`
            <div class="text-center py-8 border border-dashed border-neutral-800 rounded-lg text-neutral-600 text-sm">
                No previous scripts found
            </div>
        `,e.clearHistoryBtn.classList.add("hidden");return}e.clearHistoryBtn.classList.remove("hidden"),t.forEach(n=>{const o=document.createElement("div");o.className="bg-neutral-800 p-3 rounded border border-neutral-700 hover:border-blue-500 cursor-pointer transition group flex justify-between items-center shadow-sm",o.onclick=()=>{e.inputScript.value=n.text,C(n.text)},o.innerHTML=`
            <div class="flex flex-col text-left overflow-hidden mr-2">
                <span class="text-gray-300 text-sm font-medium truncate font-mono">${n.preview}</span>
                <span class="text-gray-500 text-xs">${n.date}</span>
            </div>
            <div class="flex-shrink-0">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-blue-500 opacity-0 group-hover:opacity-100 transition" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
            </div>
        `,e.historyList.appendChild(o)})}function _(){confirm("Clear all recent scripts?")&&(localStorage.removeItem("teleprompter_history"),v())}r.recognition&&(r.recognition.onresult=t=>{let n="";for(let i=t.resultIndex;i<t.results.length;i++)n+=t.results[i][0].transcript;const o=n.trim().toLowerCase().split(/\s+/);if(o.slice(-5).join(" ").includes("prompter restart")){b();return}M(o.slice(-5))},r.recognition.onend=()=>{if(r.isListening)try{r.recognition.start()}catch{}else S(!1)});function M(t){if(r.currentIndex>=r.scriptWords.length)return;const n=5;for(let o of t){const a=o.replace(/[^\w]|_/g,"");if(!a)continue;let i=r.currentIndex,c=0;for(;i<r.scriptWords.length&&c<n;){const s=r.scriptWords[i];if(s.skip){i++;continue}if(s.clean===a){r.currentIndex=i+1,L(),m(),B();return}i++,c++}}}function m(){r.scriptWords.forEach((t,n)=>{t.skip||t.isStop||t.element&&(n<r.currentIndex?(t.element.classList.remove("text-future","current-word","font-bold"),t.element.classList.add("text-past"),t.element.style.opacity=""):n===r.currentIndex?(t.element.classList.remove("text-future","text-past"),t.element.classList.add("current-word","font-bold"),t.element.style.opacity="1"):(t.element.classList.remove("text-past","current-word","font-bold"),t.element.classList.add("text-future"),t.element.style.opacity=""))})}function B(){if(r.currentIndex>0&&r.currentIndex<r.scriptWords.length){const t=r.scriptWords[r.currentIndex].element;if(t){const n=e.scrollContainer.clientHeight,o=t.offsetTop-n/3;e.scrollContainer.scrollTo({top:o,behavior:"smooth"})}}}function V(){if(!r.recognition)return alert("Speech recognition not supported.");r.isListening?k():z()}function z(){try{r.recognition.start(),r.isListening=!0,S(!0)}catch(t){console.error(t)}}function k(){r.isListening=!1,r.recognition.stop(),S(!1)}function S(t){const n=e.micButton,o=e.statusIndicator;t?(n.classList.add("bg-red-600","border-red-400","recording-pulse"),n.classList.remove("bg-neutral-800","border-neutral-600"),o.classList.remove("hidden")):(n.classList.remove("bg-red-600","border-red-400","recording-pulse"),n.classList.add("bg-neutral-800","border-neutral-600"),o.classList.add("hidden"))}function x(){const t=e.settingsPanel;t.classList.contains("hidden")?(t.classList.remove("hidden"),setTimeout(()=>{t.classList.remove("scale-95","opacity-0"),t.classList.add("scale-100","opacity-100")},10)):(t.classList.remove("scale-100","opacity-100"),t.classList.add("scale-95","opacity-0"),setTimeout(()=>{t.classList.add("hidden")},200))}function w(t){t==="dark"?(r.config.bgColor="#000000",r.config.textColor="#ffffff"):(r.config.bgColor="#ffffff",r.config.textColor="#000000"),e.bgColorInput.value=r.config.bgColor,e.textColorInput.value=r.config.textColor,y()}function h(t){r.config.textAlign=t,e.scriptContent.style.textAlign=t,["left","center","right"].forEach(n=>{const o=e.alignBtns[n];n===t?(o.classList.remove("hover:bg-neutral-600"),o.classList.add("bg-neutral-500","text-white")):(o.classList.add("hover:bg-neutral-600"),o.classList.remove("bg-neutral-500","text-white"))})}function y(){e.appBody.style.backgroundColor=r.config.bgColor,e.appBody.style.color=r.config.textColor}function R(){r.isMirrored=!r.isMirrored;const t=e.mirrorToggleKnob,n=e.mirrorBtn;r.isMirrored?(e.scriptContent.classList.add("mirror-mode"),t.classList.add("translate-x-6"),n.classList.add("bg-blue-600"),n.classList.remove("bg-neutral-600")):(e.scriptContent.classList.remove("mirror-mode"),t.classList.remove("translate-x-6"),n.classList.remove("bg-blue-600"),n.classList.add("bg-neutral-600"))}async function N(){const t=e.inputScript.value;if(t)try{await navigator.clipboard.writeText(t);const n=e.copyScriptBtn,o=n.innerHTML;n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" class="h-3.5 w-3.5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg> Copied!',setTimeout(()=>{n.innerHTML=o},1500)}catch(n){console.error("Failed to copy:",n),alert("Failed to copy to clipboard")}}function D(){e.inputScript.value="",e.inputScript.focus()}async function U(){try{const t=await navigator.clipboard.readText();e.inputScript.value=t,e.inputScript.focus()}catch(t){console.error("Failed to paste:",t),alert("Failed to paste from clipboard. Please grant clipboard permissions or paste manually.")}}function F(){e.loadScriptBtn.addEventListener("click",()=>C()),e.clearHistoryBtn.addEventListener("click",_),e.resetAppBtn.addEventListener("click",A),e.restartScriptBtn.addEventListener("click",b),e.micButton.addEventListener("click",V),e.toggleSettingsBtn.addEventListener("click",x),e.themeDarkBtn.addEventListener("click",()=>w("dark")),e.themeLightBtn.addEventListener("click",()=>w("light")),e.copyScriptBtn.addEventListener("click",N),e.clearScriptBtn.addEventListener("click",D),e.pasteScriptBtn.addEventListener("click",U),e.alignBtns.left.addEventListener("click",()=>h("left")),e.alignBtns.center.addEventListener("click",()=>h("center")),e.alignBtns.right.addEventListener("click",()=>h("right")),e.stopSignToggle.addEventListener("change",t=>{r.config.showStopIcon=t.target.checked,r.config.showStopIcon?e.scriptContent.classList.add("show-stops"):e.scriptContent.classList.remove("show-stops")}),e.fontSizeInput.addEventListener("input",t=>{const n=t.target.value;r.config.fontSize=parseInt(n),e.fontSizeVal.textContent=`${n}px`,e.scriptContent.style.fontSize=`${n}px`}),e.lineHeightInput.addEventListener("input",t=>{const n=t.target.value;r.config.lineHeight=parseFloat(n),e.lineHeightVal.textContent=`${n}x`,e.scriptContent.style.lineHeight=n}),e.marginInput.addEventListener("input",t=>{const n=t.target.value;r.config.margin=parseInt(n),e.marginVal.textContent=`${n}px`,e.scriptContent.style.paddingLeft=`${n}px`,e.scriptContent.style.paddingRight=`${n}px`}),e.textColorInput.addEventListener("input",t=>{r.config.textColor=t.target.value,y()}),e.bgColorInput.addEventListener("input",t=>{r.config.bgColor=t.target.value,y()}),e.mirrorBtn.addEventListener("click",R),document.addEventListener("click",t=>{const n=e.settingsPanel,o=e.toggleSettingsBtn;!n.classList.contains("hidden")&&!n.contains(t.target)&&!o.contains(t.target)&&x()})}
